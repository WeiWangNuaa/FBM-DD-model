
clc
clear all

T=100;
dt=0.1;
N=T/dt;
x0=0;

H=0.8

a=round(N.^(3/2));
V=round(logspace(log10(dt),log10(T),12)/dt);
n=1000;

parfor i=1:n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

    X(i,:)=generate_sample_LE(T,dt,H,x0,V);
    Y(i,:)=generate_sample_MN(T,dt,H,x0,a,V);
    Z(i,:)=generate_sample_levy(T,dt,H,x0,V)

end


 
% filename=['MSD_H=' num2str(H) '_T=' num2str(T) '_dt=' num2str(dt) '.mat']
% save(filename,'X', 'Y','Z','n','T','dt')

MSD_X=mean(X.^2,1);
MSD_Y=mean(Y.^2,1);
MSD_Z=mean(Z.^2,1);



%%MSD
if H==0.8
d=V*dt;
figure
loglog(d,MSD_X,'rs','markersize',8,'LineWidth',1.5)
hold on
loglog(d,MSD_Y,'bo','markersize',8,'LineWidth',1.5)
loglog(d,MSD_Z,'g^','markersize',8,'LineWidth',1.5)
loglog(d,d.^(2*H),'k--','LineWidth',1.5)
xlabel('$t$','Interpreter','latex','Fontsize',16)
ylabel('$\left< x^2(t)\right>$','Interpreter','latex','Fontsize',16) 
legend({'LE-FBM-DD','MN-FBM-DD','RL-FBM-DD'},'Interpreter','latex','Fontsize',16)    
legend('boxoff')
set(gca,'FontSize',16);

%%numerical integral
h=0.001;
for j=1:length(V)
f=@(s) 2*(V(j)*dt-s)*(h)^(-2).*(abs(s-h).^(2*H)+abs(s+h).^(2*H)-2*abs(s).^(2*H))...
    .*(sqrt(1-exp(-2*s))+exp(-s).*atan(exp(-s)./sqrt(1-exp(-2*s))))/pi;
w(j)=integral(f,0,V(j)*dt);
end
plot(V*dt,w,'r-')


%%inset
figure
s=[1:1:length(MSD_X)];
semilogx(d(s),MSD_X(s)./d(s).^(2*H),'rs','markersize',6,'LineWidth',1.5)
hold on
loglog(d(s),MSD_Y(s)./d(s).^(2*H),'bo','markersize',6,'LineWidth',1.5)
loglog(d(s),MSD_Z(s)./d(s).^(2*H),'g^','markersize',5,'LineWidth',1.5)
xlabel('$t$','Interpreter','latex','Fontsize',10)
ylabel('$\left< x^2(t)\right>/t^{2H}$','Interpreter','latex','Fontsize',10) 
set(gca,'FontSize',10);
yline(1,'k-','LineWidth',1.5)
yline(2/pi,'k-','LineWidth',1.5)
ylim([0.4 1.4])

end





%%%%%%%%%%%
if H==0.2

d=V*dt;
figure
loglog(d,MSD_X,'rs','markersize',8,'LineWidth',1.5)
hold on
loglog(d,MSD_Y,'bo','markersize',8,'LineWidth',1.5)
loglog(d,MSD_Z,'g^','markersize',8,'LineWidth',1.5)
loglog(d,d.^(2*H),'k--','LineWidth',1.5)
d1=[10 100];

loglog(d1,0.65*d1,'k--','LineWidth',1.5)
h=0.001;
for j=1:length(V)
f=@(s) 2*(V(j)*dt-s)*(h)^(-2).*(abs(s-h).^(2*H)+abs(s+h).^(2*H)-2*abs(s).^(2*H))...
    .*(sqrt(1-exp(-2*s))+exp(-s).*atan(exp(-s)./sqrt(1-exp(-2*s))))/pi;
w(j)=integral(f,0,V(j)*dt);
end
plot(V*dt,w,'r-')

xlabel('$t$','Interpreter','latex','Fontsize',16)
ylabel('$\left< x^2(t)\right>$','Interpreter','latex','Fontsize',16) 
set(gca,'FontSize',16);
box on
legend({'LE-FBM-DD','MN-FBM-DD','RL-FBM-DD'},'Interpreter','latex','Fontsize',14)    
legend('boxoff')

%%%inset
figure
s=[1:1:length(MSD_X)];
semilogx(d(s),MSD_Y(s)./d(s).^(2*H),'bo','markersize',6,'LineWidth',1.5)
hold on
loglog(d(s),MSD_Z(s)./d(s).^(2*H),'g^','markersize',5,'LineWidth',1.5)
xlabel('$t$','Interpreter','latex','Fontsize',10)
ylabel('$\left< x^2(t)\right>/t^{2H}$','Interpreter','latex','Fontsize',10) 
set(gca,'FontSize',10);
yline(1,'k-.','LineWidth',1.5)
ylim([0.4 1.2])

%%numerical

end







