
clc
clear all

T=10;
dt=0.01;
N=T/dt;
x0=0;

H=0.2
a=round(N.^(3/2));
V=[50 500];
n=10000;

parfor i=1:n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  


    X(i,:)=generate_sample_LE(T,dt,H,x0,V);
    Y(i,:)=generate_sample_MN(T,dt,H,x0,a,V);
    Z(i,:)=generate_sample_levy(T,dt,H,x0,V);


end


 
% filename=['PDF_H=' num2str(H) '_T=' num2str(T) '_dt=' num2str(dt) '.mat']
% save(filename,'X', 'Y','Z','n','T','dt')

s1=1
s2=2
o=0.1;
[x1 xx1]=pdf_plot(X(:,s1),o);
[x2 xx2]=pdf_plot(X(:,s2),o);

[y1 yy1]=pdf_plot(Y(:,s1),o);
[y2 yy2]=pdf_plot(Y(:,s2),o);

[z1 zz1]=pdf_plot(Z(:,s1),o);
[z2 zz2]=pdf_plot(Z(:,s2),o);


%%PDF
figure
v1=3;
semilogy((xx1(1:v1:end)),x1(1:v1:end),'ro','markersize',5,'LineWidth',1.5)
hold on
semilogy((yy1(1:v1:end)),y1(1:v1:end),'b^','markersize',5,'LineWidth',1.5)
hold on
semilogy((zz1(1:v1:end)),z1(1:v1:end),'go','markersize',5,'LineWidth',1.5)
hold on
set(gca,'yscale','log');
box on
hold on


v2=5;
semilogy((xx2(1:v2:end)),x2(1:v2:end),'ro','MarkerFaceColor','r','markersize',5,'LineWidth',1.5)
hold on
semilogy((yy2(1:v2:end)),y2(1:v2:end),'b^','MarkerFaceColor','b','markersize',5,'LineWidth',1.5)
hold on
semilogy((zz2(1:v2:end)),z2(1:v2:end),'go','MarkerFaceColor','g','markersize',5,'LineWidth',1.5)
hold on

f=1./(pi*sqrt((V(1)*dt).^(2*H))).*besselk(0,abs(xx1)./sqrt((V(1)*dt).^(2*H)));
semilogy(xx1,f,'r-','LineWidth',1.5)

g=1./sqrt(2*pi*(V(2)*dt).^(2*H)).*exp(-abs(xx2).^2./2./(V(2)*dt).^(2*H));
semilogy(xx2,g,'b--','LineWidth',1.5)

g=1./sqrt(2*pi*(0.65*V(2)*dt)).*exp(-abs(xx2).^2./2./(0.65*V(2)*dt));
semilogy(xx2,g,'r--','LineWidth',1.5)

set(gca,'yscale','log');
xlabel('$x$','Interpreter','latex','Fontsize',16)
ylabel('$P(x,t)$','Interpreter','latex','Fontsize',16) 
set(gca,'FontSize',16);
box on
hold on
ylim([1e-2 1e1])
legend({'LE $t=0.5$','MN $t=0.5$','RL $t=0.5$',...
    'LE $t=5$','MN $t=5$','RL $t=5$'},'Interpreter','latex','Fontsize',14)    
legend('boxoff')


